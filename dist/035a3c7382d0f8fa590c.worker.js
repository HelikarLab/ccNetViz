!function(t){var r={};function e(s){if(r[s])return r[s].exports;var o=r[s]={i:s,l:!1,exports:{}};return t[s].call(o.exports,o,o.exports,e),o.l=!0,o.exports}e.m=t,e.c=r,e.d=function(t,r,s){e.o(t,r)||Object.defineProperty(t,r,{enumerable:!0,get:s})},e.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},e.t=function(t,r){if(1&r&&(t=e(t)),8&r)return t;if(4&r&&"object"==typeof t&&t&&t.__esModule)return t;var s=Object.create(null);if(e.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:t}),2&r&&"string"!=typeof t)for(var o in t)e.d(s,o,function(r){return t[r]}.bind(null,o));return s},e.n=function(t){var r=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(r,"a",r),r},e.o=function(t,r){return Object.prototype.hasOwnProperty.call(t,r)},e.p="",e(e.s=1)}([function(t,r,e){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.create2dArray=function(t,r){return[].concat(function(t){if(Array.isArray(t)){for(var r=0,e=Array(t.length);r<t.length;r++)e[r]=t[r];return e}return Array.from(t)}(Array(t).keys())).map(function(t){return Array(r).fill(0)})},r.degrees=function(t,r){var e=Array(t.length).fill(0);r.forEach(function(t){e[t.source.index]+=1,e[t.target.index]+=1});var s=e.map(function(t,r){return{index:r,value:t}});s.sort(function(t,r){return+(t.value<r.value)||+(t.value===r.value)-1});var o=s.map(function(t){return e[t.index]});return{nodes:s,degrees:o}},r.getDepth=function t(r){var e=0;r.children&&r.children.forEach(function(r){if(1==r.depth_visited)throw new Error("This layout is only for trees acyclic graphs");r.depth_visited=!0;var s=t(r);s>e&&(e=s)});return 1+e},r.getRanges=function(t){if((t=Math.abs(t))<=1)return{start:.5,step:1};return{start:.05,step:.9/(t-1)}}},function(t,r,e){"use strict";function s(t){if(!Array.isArray(t))throw new Error("input must be an array");if(0===t.length)throw new Error("input must not be empty");for(var r=t[0],e=1;e<t.length;e++)t[e]>r&&(r=t[e]);return r}function o(t,r={}){if(!Array.isArray(t))throw new TypeError("input must be an array");if(0===t.length)throw new TypeError("input must not be empty");let e;if(void 0!==r.output){if(!Array.isArray(r.output))throw new TypeError("output option must be an array if specified");e=r.output}else e=new Array(t.length);const o=function(t){if(!Array.isArray(t))throw new Error("input must be an array");if(0===t.length)throw new Error("input must not be empty");for(var r=t[0],e=1;e<t.length;e++)t[e]<r&&(r=t[e]);return r}(t),n=s(t);if(o===n)throw new RangeError("minimum and maximum input values are equal. Cannot rescale a constant array");const{min:i=(r.autoMinMax?o:0),max:a=(r.autoMinMax?n:1)}=r;if(i>=a)throw new RangeError("min option must be smaller than max option");const h=(a-i)/(n-o);for(var u=0;u<t.length;u++)e[u]=(t[u]-o)*h+i;return e}e.r(r);class n{constructor(t){var r,e,s,o,n,i,a,h,u,l=(t=I.checkMatrix(t)).clone(),f=l.rows,c=l.columns,m=new Array(f),g=1;for(r=0;r<f;r++)m[r]=r;for(h=new Array(f),e=0;e<c;e++){for(r=0;r<f;r++)h[r]=l.get(r,e);for(r=0;r<f;r++){for(u=Math.min(r,e),n=0,s=0;s<u;s++)n+=l.get(r,s)*h[s];h[r]-=n,l.set(r,e,h[r])}for(o=e,r=e+1;r<f;r++)Math.abs(h[r])>Math.abs(h[o])&&(o=r);if(o!==e){for(s=0;s<c;s++)i=l.get(o,s),l.set(o,s,l.get(e,s)),l.set(e,s,i);a=m[o],m[o]=m[e],m[e]=a,g=-g}if(e<f&&0!==l.get(e,e))for(r=e+1;r<f;r++)l.set(r,e,l.get(r,e)/l.get(e,e))}this.LU=l,this.pivotVector=m,this.pivotSign=g}isSingular(){for(var t=this.LU,r=t.columns,e=0;e<r;e++)if(0===t[e][e])return!0;return!1}solve(t){t=C.checkMatrix(t);var r=this.LU;if(r.rows!==t.rows)throw new Error("Invalid matrix dimensions");if(this.isSingular())throw new Error("LU matrix is singular");var e,s,o,n=t.columns,i=t.subMatrixRow(this.pivotVector,0,n-1),a=r.columns;for(o=0;o<a;o++)for(e=o+1;e<a;e++)for(s=0;s<n;s++)i[e][s]-=i[o][s]*r[e][o];for(o=a-1;o>=0;o--){for(s=0;s<n;s++)i[o][s]/=r[o][o];for(e=0;e<o;e++)for(s=0;s<n;s++)i[e][s]-=i[o][s]*r[e][o]}return i}get determinant(){var t=this.LU;if(!t.isSquare())throw new Error("Matrix must be square");for(var r=this.pivotSign,e=t.columns,s=0;s<e;s++)r*=t[s][s];return r}get lowerTriangularMatrix(){for(var t=this.LU,r=t.rows,e=t.columns,s=new C(r,e),o=0;o<r;o++)for(var n=0;n<e;n++)s[o][n]=o>n?t[o][n]:o===n?1:0;return s}get upperTriangularMatrix(){for(var t=this.LU,r=t.rows,e=t.columns,s=new C(r,e),o=0;o<r;o++)for(var n=0;n<e;n++)s[o][n]=o<=n?t[o][n]:0;return s}get pivotPermutationVector(){return this.pivotVector.slice()}}function i(t,r){var e=0;return Math.abs(t)>Math.abs(r)?(e=r/t,Math.abs(t)*Math.sqrt(1+e*e)):0!==r?(e=t/r,Math.abs(r)*Math.sqrt(1+e*e)):0}function a(t,r,e){for(var s=new Array(t),o=0;o<t;o++){s[o]=new Array(r);for(var n=0;n<r;n++)s[o][n]=e}return s}class h{constructor(t,r={}){var e=(t=I.checkMatrix(t)).rows,s=t.columns;const{computeLeftSingularVectors:o=!0,computeRightSingularVectors:n=!0,autoTranspose:h=!1}=r;var u,l=Boolean(o),f=Boolean(n),c=!1;if(e<s)if(h){e=(u=t.transpose()).rows,s=u.columns,c=!0;var m=l;l=f,f=m}else u=t.clone(),console.warn("Computing SVD on a matrix with more columns than rows. Consider enabling autoTranspose");else u=t.clone();var g=Math.min(e,s),w=Math.min(e+1,s),v=new Array(w),d=a(e,g,0),p=a(s,s,0),M=new Array(s),b=new Array(e),x=new Array(w);for(let t=0;t<w;t++)x[t]=t;var y=Math.min(e-1,s),S=Math.max(0,Math.min(s-2,e)),E=Math.max(y,S);for(let t=0;t<E;t++){if(t<y){v[t]=0;for(let r=t;r<e;r++)v[t]=i(v[t],u[r][t]);if(0!==v[t]){u[t][t]<0&&(v[t]=-v[t]);for(let r=t;r<e;r++)u[r][t]/=v[t];u[t][t]+=1}v[t]=-v[t]}for(let r=t+1;r<s;r++){if(t<y&&0!==v[t]){let s=0;for(let o=t;o<e;o++)s+=u[o][t]*u[o][r];s=-s/u[t][t];for(let o=t;o<e;o++)u[o][r]+=s*u[o][t]}M[r]=u[t][r]}if(l&&t<y)for(let r=t;r<e;r++)d[r][t]=u[r][t];if(t<S){M[t]=0;for(let r=t+1;r<s;r++)M[t]=i(M[t],M[r]);if(0!==M[t]){M[t+1]<0&&(M[t]=0-M[t]);for(let r=t+1;r<s;r++)M[r]/=M[t];M[t+1]+=1}if(M[t]=-M[t],t+1<e&&0!==M[t]){for(let r=t+1;r<e;r++)b[r]=0;for(let r=t+1;r<e;r++)for(let e=t+1;e<s;e++)b[r]+=M[e]*u[r][e];for(let r=t+1;r<s;r++){let s=-M[r]/M[t+1];for(let o=t+1;o<e;o++)u[o][r]+=s*b[o]}}if(f)for(let r=t+1;r<s;r++)p[r][t]=M[r]}}let A=Math.min(s,e+1);if(y<s&&(v[y]=u[y][y]),e<A&&(v[A-1]=0),S+1<A&&(M[S]=u[S][A-1]),M[A-1]=0,l){for(let t=y;t<g;t++){for(let r=0;r<e;r++)d[r][t]=0;d[t][t]=1}for(let t=y-1;t>=0;t--)if(0!==v[t]){for(let r=t+1;r<g;r++){let s=0;for(let o=t;o<e;o++)s+=d[o][t]*d[o][r];s=-s/d[t][t];for(let o=t;o<e;o++)d[o][r]+=s*d[o][t]}for(let r=t;r<e;r++)d[r][t]=-d[r][t];d[t][t]=1+d[t][t];for(let r=0;r<t-1;r++)d[r][t]=0}else{for(let r=0;r<e;r++)d[r][t]=0;d[t][t]=1}}if(f)for(let t=s-1;t>=0;t--){if(t<S&&0!==M[t])for(let r=t+1;r<s;r++){let e=0;for(let o=t+1;o<s;o++)e+=p[o][t]*p[o][r];e=-e/p[t+1][t];for(let o=t+1;o<s;o++)p[o][r]+=e*p[o][t]}for(let r=0;r<s;r++)p[r][t]=0;p[t][t]=1}for(var R=A-1,V=Number.EPSILON;A>0;){let t,r;for(t=A-2;t>=-1&&-1!==t;t--){const r=Number.MIN_VALUE+V*Math.abs(v[t]+Math.abs(v[t+1]));if(Math.abs(M[t])<=r||Number.isNaN(M[t])){M[t]=0;break}}if(t===A-2)r=4;else{let e;for(e=A-1;e>=t&&e!==t;e--){let r=(e!==A?Math.abs(M[e]):0)+(e!==t+1?Math.abs(M[e-1]):0);if(Math.abs(v[e])<=V*r){v[e]=0;break}}e===t?r=3:e===A-1?r=1:(r=2,t=e)}switch(t++,r){case 1:{let r=M[A-2];M[A-2]=0;for(let e=A-2;e>=t;e--){let o=i(v[e],r),n=v[e]/o,a=r/o;if(v[e]=o,e!==t&&(r=-a*M[e-1],M[e-1]=n*M[e-1]),f)for(let t=0;t<s;t++)o=n*p[t][e]+a*p[t][A-1],p[t][A-1]=-a*p[t][e]+n*p[t][A-1],p[t][e]=o}break}case 2:{let r=M[t-1];M[t-1]=0;for(let s=t;s<A;s++){let o=i(v[s],r),n=v[s]/o,a=r/o;if(v[s]=o,r=-a*M[s],M[s]=n*M[s],l)for(let r=0;r<e;r++)o=n*d[r][s]+a*d[r][t-1],d[r][t-1]=-a*d[r][s]+n*d[r][t-1],d[r][s]=o}break}case 3:{const r=Math.max(Math.abs(v[A-1]),Math.abs(v[A-2]),Math.abs(M[A-2]),Math.abs(v[t]),Math.abs(M[t])),o=v[A-1]/r,n=v[A-2]/r,a=M[A-2]/r,h=v[t]/r,u=M[t]/r,c=((n+o)*(n-o)+a*a)/2,m=o*a*(o*a);let g=0;0===c&&0===m||(g=m/(c+(g=c<0?0-Math.sqrt(c*c+m):Math.sqrt(c*c+m))));let w=(h+o)*(h-o)+g,b=h*u;for(let r=t;r<A-1;r++){let o=i(w,b);0===o&&(o=Number.MIN_VALUE);let n=w/o,a=b/o;if(r!==t&&(M[r-1]=o),w=n*v[r]+a*M[r],M[r]=n*M[r]-a*v[r],b=a*v[r+1],v[r+1]=n*v[r+1],f)for(let t=0;t<s;t++)o=n*p[t][r]+a*p[t][r+1],p[t][r+1]=-a*p[t][r]+n*p[t][r+1],p[t][r]=o;if(0===(o=i(w,b))&&(o=Number.MIN_VALUE),n=w/o,a=b/o,v[r]=o,w=n*M[r]+a*v[r+1],v[r+1]=-a*M[r]+n*v[r+1],b=a*M[r+1],M[r+1]=n*M[r+1],l&&r<e-1)for(let t=0;t<e;t++)o=n*d[t][r]+a*d[t][r+1],d[t][r+1]=-a*d[t][r]+n*d[t][r+1],d[t][r]=o}M[A-2]=w,1;break}case 4:if(v[t]<=0&&(v[t]=v[t]<0?-v[t]:0,f))for(let r=0;r<=R;r++)p[r][t]=-p[r][t];for(;t<R&&!(v[t]>=v[t+1]);){let r=v[t];if(v[t]=v[t+1],v[t+1]=r,f&&t<s-1)for(let e=0;e<s;e++)r=p[e][t+1],p[e][t+1]=p[e][t],p[e][t]=r;if(l&&t<e-1)for(let s=0;s<e;s++)r=d[s][t+1],d[s][t+1]=d[s][t],d[s][t]=r;t++}0,A--}}if(c){var j=p;p=d,d=j}this.m=e,this.n=s,this.s=v,this.U=d,this.V=p}solve(t){var r=t,e=this.threshold,s=this.s.length,o=C.zeros(s,s);for(let t=0;t<s;t++)Math.abs(this.s[t])<=e?o[t][t]=0:o[t][t]=1/this.s[t];var n=this.U,i=this.rightSingularVectors,a=i.mmul(o),h=i.rows,u=n.length,l=C.zeros(h,u);for(let t=0;t<h;t++)for(let r=0;r<u;r++){let e=0;for(let o=0;o<s;o++)e+=a[t][o]*n[r][o];l[t][r]=e}return l.mmul(r)}solveForDiagonal(t){return this.solve(C.diag(t))}inverse(){var t=this.V,r=this.threshold,e=t.length,s=t[0].length,o=new C(e,this.s.length);for(let n=0;n<e;n++)for(let e=0;e<s;e++)Math.abs(this.s[e])>r?o[n][e]=t[n][e]/this.s[e]:o[n][e]=0;var n=this.U,i=n.length,a=n[0].length,h=new C(e,i);for(let t=0;t<e;t++)for(let r=0;r<i;r++){let e=0;for(let s=0;s<a;s++)e+=o[t][s]*n[r][s];h[t][r]=e}return h}get condition(){return this.s[0]/this.s[Math.min(this.m,this.n)-1]}get norm2(){return this.s[0]}get rank(){for(var t=Math.max(this.m,this.n)*this.s[0]*Number.EPSILON,r=0,e=this.s,s=0,o=e.length;s<o;s++)e[s]>t&&r++;return r}get diagonal(){return this.s}get threshold(){return Number.EPSILON/2*Math.max(this.m,this.n)*this.s[0]}get leftSingularVectors(){return C.isMatrix(this.U)||(this.U=new C(this.U)),this.U}get rightSingularVectors(){return C.isMatrix(this.V)||(this.V=new C(this.V)),this.V}get diagonalMatrix(){return C.diag(this.s)}}function u(t,r,e){var s=e?t.rows:t.rows-1;if(r<0||r>s)throw new RangeError("Row index out of range")}function l(t,r,e){var s=e?t.columns:t.columns-1;if(r<0||r>s)throw new RangeError("Column index out of range")}function f(t,r){if(r.to1DArray&&(r=r.to1DArray()),r.length!==t.columns)throw new RangeError("vector size must be the same as the number of columns");return r}function c(t,r){if(r.to1DArray&&(r=r.to1DArray()),r.length!==t.rows)throw new RangeError("vector size must be the same as the number of rows");return r}function m(t,r,e){return{row:g(t,r),column:w(t,e)}}function g(t,r){if("object"!=typeof r)throw new TypeError("unexpected type for row indices");if(r.some(r=>r<0||r>=t.rows))throw new RangeError("row indices are out of range");return Array.isArray(r)||(r=Array.from(r)),r}function w(t,r){if("object"!=typeof r)throw new TypeError("unexpected type for column indices");if(r.some(r=>r<0||r>=t.columns))throw new RangeError("column indices are out of range");return Array.isArray(r)||(r=Array.from(r)),r}function v(t,r,e,s,o){if(5!==arguments.length)throw new RangeError("expected 4 arguments");if(d("startRow",r),d("endRow",e),d("startColumn",s),d("endColumn",o),r>e||s>o||r<0||r>=t.rows||e<0||e>=t.rows||s<0||s>=t.columns||o<0||o>=t.columns)throw new RangeError("Submatrix indices are out of range")}function d(t,r){if("number"!=typeof r)throw new TypeError(`${t} must be a number`)}class p extends(j()){constructor(t,r,e){super(),this.matrix=t,this.rows=r,this.columns=e}static get[Symbol.species](){return C}}class M extends p{constructor(t){super(t,t.columns,t.rows)}set(t,r,e){return this.matrix.set(r,t,e),this}get(t,r){return this.matrix.get(r,t)}}class b extends p{constructor(t,r){super(t,1,t.columns),this.row=r}set(t,r,e){return this.matrix.set(this.row,r,e),this}get(t,r){return this.matrix.get(this.row,r)}}class x extends p{constructor(t,r,e,s,o){v(t,r,e,s,o),super(t,e-r+1,o-s+1),this.startRow=r,this.startColumn=s}set(t,r,e){return this.matrix.set(this.startRow+t,this.startColumn+r,e),this}get(t,r){return this.matrix.get(this.startRow+t,this.startColumn+r)}}class y extends p{constructor(t,r,e){var s=m(t,r,e);super(t,s.row.length,s.column.length),this.rowIndices=s.row,this.columnIndices=s.column}set(t,r,e){return this.matrix.set(this.rowIndices[t],this.columnIndices[r],e),this}get(t,r){return this.matrix.get(this.rowIndices[t],this.columnIndices[r])}}class S extends p{constructor(t,r){super(t,(r=g(t,r)).length,t.columns),this.rowIndices=r}set(t,r,e){return this.matrix.set(this.rowIndices[t],r,e),this}get(t,r){return this.matrix.get(this.rowIndices[t],r)}}class E extends p{constructor(t,r){r=w(t,r),super(t,t.rows,r.length),this.columnIndices=r}set(t,r,e){return this.matrix.set(t,this.columnIndices[r],e),this}get(t,r){return this.matrix.get(t,this.columnIndices[r])}}class A extends p{constructor(t,r){super(t,t.rows,1),this.column=r}set(t,r,e){return this.matrix.set(t,this.column,e),this}get(t){return this.matrix.get(t,this.column)}}class R extends p{constructor(t){super(t,t.rows,t.columns)}set(t,r,e){return this.matrix.set(this.rows-t-1,r,e),this}get(t,r){return this.matrix.get(this.rows-t-1,r)}}class V extends p{constructor(t){super(t,t.rows,t.columns)}set(t,r,e){return this.matrix.set(t,this.columns-r-1,e),this}get(t,r){return this.matrix.get(t,this.columns-r-1)}}function j(t){void 0===t&&(t=Object);class r extends t{static get[Symbol.species](){return this}static from1DArray(t,r,e){if(t*r!==e.length)throw new RangeError("Data length does not match given dimensions");for(var s=new this(t,r),o=0;o<t;o++)for(var n=0;n<r;n++)s.set(o,n,e[o*r+n]);return s}static rowVector(t){for(var r=new this(1,t.length),e=0;e<t.length;e++)r.set(0,e,t[e]);return r}static columnVector(t){for(var r=new this(t.length,1),e=0;e<t.length;e++)r.set(e,0,t[e]);return r}static empty(t,r){return new this(t,r)}static zeros(t,r){return this.empty(t,r).fill(0)}static ones(t,r){return this.empty(t,r).fill(1)}static rand(t,r,e){void 0===e&&(e=Math.random);for(var s=this.empty(t,r),o=0;o<t;o++)for(var n=0;n<r;n++)s.set(o,n,e());return s}static randInt(t,r,e,s){void 0===e&&(e=1e3),void 0===s&&(s=Math.random);for(var o=this.empty(t,r),n=0;n<t;n++)for(var i=0;i<r;i++){var a=Math.floor(s()*e);o.set(n,i,a)}return o}static eye(t,r,e){void 0===r&&(r=t),void 0===e&&(e=1);for(var s=Math.min(t,r),o=this.zeros(t,r),n=0;n<s;n++)o.set(n,n,e);return o}static diag(t,r,e){var s=t.length;void 0===r&&(r=s),void 0===e&&(e=r);for(var o=Math.min(s,r,e),n=this.zeros(r,e),i=0;i<o;i++)n.set(i,i,t[i]);return n}static min(t,r){t=this.checkMatrix(t),r=this.checkMatrix(r);for(var e=t.rows,s=t.columns,o=new this(e,s),n=0;n<e;n++)for(var i=0;i<s;i++)o.set(n,i,Math.min(t.get(n,i),r.get(n,i)));return o}static max(t,r){t=this.checkMatrix(t),r=this.checkMatrix(r);for(var e=t.rows,s=t.columns,o=new this(e,s),n=0;n<e;n++)for(var i=0;i<s;i++)o.set(n,i,Math.max(t.get(n,i),r.get(n,i)));return o}static checkMatrix(t){return r.isMatrix(t)?t:new this(t)}static isMatrix(t){return null!=t&&"Matrix"===t.klass}get size(){return this.rows*this.columns}apply(t){if("function"!=typeof t)throw new TypeError("callback must be a function");for(var r=this.rows,e=this.columns,s=0;s<r;s++)for(var o=0;o<e;o++)t.call(this,s,o);return this}to1DArray(){for(var t=new Array(this.size),r=0;r<this.rows;r++)for(var e=0;e<this.columns;e++)t[r*this.columns+e]=this.get(r,e);return t}to2DArray(){for(var t=new Array(this.rows),r=0;r<this.rows;r++){t[r]=new Array(this.columns);for(var e=0;e<this.columns;e++)t[r][e]=this.get(r,e)}return t}isRowVector(){return 1===this.rows}isColumnVector(){return 1===this.columns}isVector(){return 1===this.rows||1===this.columns}isSquare(){return this.rows===this.columns}isSymmetric(){if(this.isSquare()){for(var t=0;t<this.rows;t++)for(var r=0;r<=t;r++)if(this.get(t,r)!==this.get(r,t))return!1;return!0}return!1}set(t,r,e){throw new Error("set method is unimplemented")}get(t,r){throw new Error("get method is unimplemented")}repeat(t,r){t=t||1,r=r||1;for(var e=new this.constructor[Symbol.species](this.rows*t,this.columns*r),s=0;s<t;s++)for(var o=0;o<r;o++)e.setSubMatrix(this,this.rows*s,this.columns*o);return e}fill(t){for(var r=0;r<this.rows;r++)for(var e=0;e<this.columns;e++)this.set(r,e,t);return this}neg(){return this.mulS(-1)}getRow(t){u(this,t);for(var r=new Array(this.columns),e=0;e<this.columns;e++)r[e]=this.get(t,e);return r}getRowVector(t){return this.constructor.rowVector(this.getRow(t))}setRow(t,r){u(this,t),r=f(this,r);for(var e=0;e<this.columns;e++)this.set(t,e,r[e]);return this}swapRows(t,r){u(this,t),u(this,r);for(var e=0;e<this.columns;e++){var s=this.get(t,e);this.set(t,e,this.get(r,e)),this.set(r,e,s)}return this}getColumn(t){l(this,t);for(var r=new Array(this.rows),e=0;e<this.rows;e++)r[e]=this.get(e,t);return r}getColumnVector(t){return this.constructor.columnVector(this.getColumn(t))}setColumn(t,r){l(this,t),r=c(this,r);for(var e=0;e<this.rows;e++)this.set(e,t,r[e]);return this}swapColumns(t,r){l(this,t),l(this,r);for(var e=0;e<this.rows;e++){var s=this.get(e,t);this.set(e,t,this.get(e,r)),this.set(e,r,s)}return this}addRowVector(t){t=f(this,t);for(var r=0;r<this.rows;r++)for(var e=0;e<this.columns;e++)this.set(r,e,this.get(r,e)+t[e]);return this}subRowVector(t){t=f(this,t);for(var r=0;r<this.rows;r++)for(var e=0;e<this.columns;e++)this.set(r,e,this.get(r,e)-t[e]);return this}mulRowVector(t){t=f(this,t);for(var r=0;r<this.rows;r++)for(var e=0;e<this.columns;e++)this.set(r,e,this.get(r,e)*t[e]);return this}divRowVector(t){t=f(this,t);for(var r=0;r<this.rows;r++)for(var e=0;e<this.columns;e++)this.set(r,e,this.get(r,e)/t[e]);return this}addColumnVector(t){t=c(this,t);for(var r=0;r<this.rows;r++)for(var e=0;e<this.columns;e++)this.set(r,e,this.get(r,e)+t[r]);return this}subColumnVector(t){t=c(this,t);for(var r=0;r<this.rows;r++)for(var e=0;e<this.columns;e++)this.set(r,e,this.get(r,e)-t[r]);return this}mulColumnVector(t){t=c(this,t);for(var r=0;r<this.rows;r++)for(var e=0;e<this.columns;e++)this.set(r,e,this.get(r,e)*t[r]);return this}divColumnVector(t){t=c(this,t);for(var r=0;r<this.rows;r++)for(var e=0;e<this.columns;e++)this.set(r,e,this.get(r,e)/t[r]);return this}mulRow(t,r){u(this,t);for(var e=0;e<this.columns;e++)this.set(t,e,this.get(t,e)*r);return this}mulColumn(t,r){l(this,t);for(var e=0;e<this.rows;e++)this.set(e,t,this.get(e,t)*r);return this}max(){for(var t=this.get(0,0),r=0;r<this.rows;r++)for(var e=0;e<this.columns;e++)this.get(r,e)>t&&(t=this.get(r,e));return t}maxIndex(){for(var t=this.get(0,0),r=[0,0],e=0;e<this.rows;e++)for(var s=0;s<this.columns;s++)this.get(e,s)>t&&(t=this.get(e,s),r[0]=e,r[1]=s);return r}min(){for(var t=this.get(0,0),r=0;r<this.rows;r++)for(var e=0;e<this.columns;e++)this.get(r,e)<t&&(t=this.get(r,e));return t}minIndex(){for(var t=this.get(0,0),r=[0,0],e=0;e<this.rows;e++)for(var s=0;s<this.columns;s++)this.get(e,s)<t&&(t=this.get(e,s),r[0]=e,r[1]=s);return r}maxRow(t){u(this,t);for(var r=this.get(t,0),e=1;e<this.columns;e++)this.get(t,e)>r&&(r=this.get(t,e));return r}maxRowIndex(t){u(this,t);for(var r=this.get(t,0),e=[t,0],s=1;s<this.columns;s++)this.get(t,s)>r&&(r=this.get(t,s),e[1]=s);return e}minRow(t){u(this,t);for(var r=this.get(t,0),e=1;e<this.columns;e++)this.get(t,e)<r&&(r=this.get(t,e));return r}minRowIndex(t){u(this,t);for(var r=this.get(t,0),e=[t,0],s=1;s<this.columns;s++)this.get(t,s)<r&&(r=this.get(t,s),e[1]=s);return e}maxColumn(t){l(this,t);for(var r=this.get(0,t),e=1;e<this.rows;e++)this.get(e,t)>r&&(r=this.get(e,t));return r}maxColumnIndex(t){l(this,t);for(var r=this.get(0,t),e=[0,t],s=1;s<this.rows;s++)this.get(s,t)>r&&(r=this.get(s,t),e[0]=s);return e}minColumn(t){l(this,t);for(var r=this.get(0,t),e=1;e<this.rows;e++)this.get(e,t)<r&&(r=this.get(e,t));return r}minColumnIndex(t){l(this,t);for(var r=this.get(0,t),e=[0,t],s=1;s<this.rows;s++)this.get(s,t)<r&&(r=this.get(s,t),e[0]=s);return e}diag(){for(var t=Math.min(this.rows,this.columns),r=new Array(t),e=0;e<t;e++)r[e]=this.get(e,e);return r}sum(t){switch(t){case"row":return function(t){for(var r=C.zeros(t.rows,1),e=0;e<t.rows;++e)for(var s=0;s<t.columns;++s)r.set(e,0,r.get(e,0)+t.get(e,s));return r}(this);case"column":return function(t){for(var r=C.zeros(1,t.columns),e=0;e<t.rows;++e)for(var s=0;s<t.columns;++s)r.set(0,s,r.get(0,s)+t.get(e,s));return r}(this);default:return function(t){for(var r=0,e=0;e<t.rows;e++)for(var s=0;s<t.columns;s++)r+=t.get(e,s);return r}(this)}}mean(){return this.sum()/this.size}prod(){for(var t=1,r=0;r<this.rows;r++)for(var e=0;e<this.columns;e++)t*=this.get(r,e);return t}norm(t="frobenius"){var r=0;if("max"===t)return this.max();if("frobenius"===t){for(var e=0;e<this.rows;e++)for(var s=0;s<this.columns;s++)r+=this.get(e,s)*this.get(e,s);return Math.sqrt(r)}throw new RangeError(`unknown norm type: ${t}`)}cumulativeSum(){for(var t=0,r=0;r<this.rows;r++)for(var e=0;e<this.columns;e++)t+=this.get(r,e),this.set(r,e,t);return this}dot(t){r.isMatrix(t)&&(t=t.to1DArray());var e=this.to1DArray();if(e.length!==t.length)throw new RangeError("vectors do not have the same size");for(var s=0,o=0;o<e.length;o++)s+=e[o]*t[o];return s}mmul(t){t=this.constructor.checkMatrix(t),this.columns!==t.rows&&console.warn("Number of columns of left matrix are not equal to number of rows of right matrix.");for(var r=this.rows,e=this.columns,s=t.columns,o=new this.constructor[Symbol.species](r,s),n=new Array(e),i=0;i<s;i++){for(var a=0;a<e;a++)n[a]=t.get(a,i);for(var h=0;h<r;h++){var u=0;for(a=0;a<e;a++)u+=this.get(h,a)*n[a];o.set(h,i,u)}}return o}strassen2x2(t){var r=new this.constructor[Symbol.species](2,2);const e=this.get(0,0),s=t.get(0,0),o=this.get(0,1),n=t.get(0,1),i=this.get(1,0),a=t.get(1,0),h=this.get(1,1),u=t.get(1,1),l=(e+h)*(s+u),f=(i+h)*s,c=e*(n-u),m=h*(a-s),g=(e+o)*u,w=l+m-g+(o-h)*(a+u),v=c+g,d=f+m,p=l-f+c+(i-e)*(s+n);return r.set(0,0,w),r.set(0,1,v),r.set(1,0,d),r.set(1,1,p),r}strassen3x3(t){var r=new this.constructor[Symbol.species](3,3);const e=this.get(0,0),s=this.get(0,1),o=this.get(0,2),n=this.get(1,0),i=this.get(1,1),a=this.get(1,2),h=this.get(2,0),u=this.get(2,1),l=this.get(2,2),f=t.get(0,0),c=t.get(0,1),m=t.get(0,2),g=t.get(1,0),w=t.get(1,1),v=t.get(1,2),d=t.get(2,0),p=t.get(2,1),M=t.get(2,2),b=(e-n)*(-c+w),x=(-e+n+i)*(f-c+w),y=(n+i)*(-f+c),S=e*f,E=(-e+h+u)*(f-m+v),A=(-e+h)*(m-v),R=(h+u)*(-f+m),V=(-o+u+l)*(w+d-p),j=(o-l)*(w-p),C=o*d,I=(u+l)*(-d+p),k=(-o+i+a)*(v+d-M),q=(o-a)*(v-M),N=(i+a)*(-d+M),_=S+C+s*g,O=(e+s+o-n-i-u-l)*w+x+y+S+V+C+I,L=S+E+R+(e+s+o-i-a-h-u)*v+C+k+N,T=b+i*(-f+c+g-w-v-d+M)+x+S+C+k+q,z=b+x+y+S+a*p,P=C+k+q+N+n*m,U=S+E+A+u*(-f+m+g-w-v-d+p)+V+j+C,$=V+j+C+I+h*c,D=S+E+A+R+l*M;return r.set(0,0,_),r.set(0,1,O),r.set(0,2,L),r.set(1,0,T),r.set(1,1,z),r.set(1,2,P),r.set(2,0,U),r.set(2,1,$),r.set(2,2,D),r}mmulStrassen(t){var e=this.clone(),s=e.rows,o=e.columns,n=t.rows,i=t.columns;function a(t,e,s){var o=t.rows,n=t.columns;if(o===e&&n===s)return t;var i=r.zeros(e,s);return i=i.setSubMatrix(t,0,0)}o!==n&&console.warn(`Multiplying ${s} x ${o} and ${n} x ${i} matrix: dimensions do not match.`);var h=Math.max(s,n),u=Math.max(o,i);return function t(e,s,o,n){if(o<=512||n<=512)return e.mmul(s);o%2==1&&n%2==1?(e=a(e,o+1,n+1),s=a(s,o+1,n+1)):o%2==1?(e=a(e,o+1,n),s=a(s,o+1,n)):n%2==1&&(e=a(e,o,n+1),s=a(s,o,n+1));var i=parseInt(e.rows/2,10),h=parseInt(e.columns/2,10),u=e.subMatrix(0,i-1,0,h-1),l=s.subMatrix(0,i-1,0,h-1),f=e.subMatrix(0,i-1,h,e.columns-1),c=s.subMatrix(0,i-1,h,s.columns-1),m=e.subMatrix(i,e.rows-1,0,h-1),g=s.subMatrix(i,s.rows-1,0,h-1),w=e.subMatrix(i,e.rows-1,h,e.columns-1),v=s.subMatrix(i,s.rows-1,h,s.columns-1),d=t(r.add(u,w),r.add(l,v),i,h),p=t(r.add(m,w),l,i,h),M=t(u,r.sub(c,v),i,h),b=t(w,r.sub(g,l),i,h),x=t(r.add(u,f),v,i,h),y=t(r.sub(m,u),r.add(l,c),i,h),S=t(r.sub(f,w),r.add(g,v),i,h),E=r.add(d,b);E.sub(x),E.add(S);var A=r.add(M,x),R=r.add(p,b),V=r.sub(d,p);V.add(M),V.add(y);var j=r.zeros(2*E.rows,2*E.columns);return(j=(j=(j=(j=j.setSubMatrix(E,0,0)).setSubMatrix(A,E.rows,0)).setSubMatrix(R,0,E.columns)).setSubMatrix(V,E.rows,E.columns)).subMatrix(0,o-1,0,n-1)}(e=a(e,h,u),t=a(t,h,u),h,u)}scaleRows(t,r){if((t=void 0===t?0:t)>=(r=void 0===r?1:r))throw new RangeError("min should be strictly smaller than max");for(var e=this.constructor.empty(this.rows,this.columns),s=0;s<this.rows;s++){var n=o(this.getRow(s),{min:t,max:r});e.setRow(s,n)}return e}scaleColumns(t,r){if((t=void 0===t?0:t)>=(r=void 0===r?1:r))throw new RangeError("min should be strictly smaller than max");for(var e=this.constructor.empty(this.rows,this.columns),s=0;s<this.columns;s++){var n=o(this.getColumn(s),{min:t,max:r});e.setColumn(s,n)}return e}kroneckerProduct(t){t=this.constructor.checkMatrix(t);for(var r=this.rows,e=this.columns,s=t.rows,o=t.columns,n=new this.constructor[Symbol.species](r*s,e*o),i=0;i<r;i++)for(var a=0;a<e;a++)for(var h=0;h<s;h++)for(var u=0;u<o;u++)n[s*i+h][o*a+u]=this.get(i,a)*t.get(h,u);return n}transpose(){for(var t=new this.constructor[Symbol.species](this.columns,this.rows),r=0;r<this.rows;r++)for(var e=0;e<this.columns;e++)t.set(e,r,this.get(r,e));return t}sortRows(t){void 0===t&&(t=e);for(var r=0;r<this.rows;r++)this.setRow(r,this.getRow(r).sort(t));return this}sortColumns(t){void 0===t&&(t=e);for(var r=0;r<this.columns;r++)this.setColumn(r,this.getColumn(r).sort(t));return this}subMatrix(t,r,e,s){v(this,t,r,e,s);for(var o=new this.constructor[Symbol.species](r-t+1,s-e+1),n=t;n<=r;n++)for(var i=e;i<=s;i++)o[n-t][i-e]=this.get(n,i);return o}subMatrixRow(t,r,e){if(void 0===r&&(r=0),void 0===e&&(e=this.columns-1),r>e||r<0||r>=this.columns||e<0||e>=this.columns)throw new RangeError("Argument out of range");for(var s=new this.constructor[Symbol.species](t.length,e-r+1),o=0;o<t.length;o++)for(var n=r;n<=e;n++){if(t[o]<0||t[o]>=this.rows)throw new RangeError(`Row index out of range: ${t[o]}`);s.set(o,n-r,this.get(t[o],n))}return s}subMatrixColumn(t,r,e){if(void 0===r&&(r=0),void 0===e&&(e=this.rows-1),r>e||r<0||r>=this.rows||e<0||e>=this.rows)throw new RangeError("Argument out of range");for(var s=new this.constructor[Symbol.species](e-r+1,t.length),o=0;o<t.length;o++)for(var n=r;n<=e;n++){if(t[o]<0||t[o]>=this.columns)throw new RangeError(`Column index out of range: ${t[o]}`);s.set(n-r,o,this.get(n,t[o]))}return s}setSubMatrix(t,r,e){v(this,r,r+(t=this.constructor.checkMatrix(t)).rows-1,e,e+t.columns-1);for(var s=0;s<t.rows;s++)for(var o=0;o<t.columns;o++)this[r+s][e+o]=t.get(s,o);return this}selection(t,r){for(var e=m(this,t,r),s=new this.constructor[Symbol.species](t.length,r.length),o=0;o<e.row.length;o++)for(var n=e.row[o],i=0;i<e.column.length;i++){var a=e.column[i];s[o][i]=this.get(n,a)}return s}trace(){for(var t=Math.min(this.rows,this.columns),r=0,e=0;e<t;e++)r+=this.get(e,e);return r}transposeView(){return new M(this)}rowView(t){return u(this,t),new b(this,t)}columnView(t){return l(this,t),new A(this,t)}flipRowView(){return new R(this)}flipColumnView(){return new V(this)}subMatrixView(t,r,e,s){return new x(this,t,r,e,s)}selectionView(t,r){return new y(this,t,r)}rowSelectionView(t){return new S(this,t)}columnSelectionView(t){return new E(this,t)}det(){var t,r,e,s,o,i;if(this.isSquare())return 2===this.columns?(t=this.get(0,0),r=this.get(0,1),e=this.get(1,0),t*this.get(1,1)-r*e):3===this.columns?(s=this.selectionView([1,2],[1,2]),o=this.selectionView([1,2],[0,2]),i=this.selectionView([1,2],[0,1]),t=this.get(0,0),r=this.get(0,1),e=this.get(0,2),t*s.det()-r*o.det()+e*i.det()):new n(this).determinant;throw Error("Determinant can only be calculated for a square matrix.")}pseudoInverse(t){void 0===t&&(t=Number.EPSILON);for(var r=new h(this,{autoTranspose:!0}),e=r.leftSingularVectors,s=r.rightSingularVectors,o=r.diagonal,n=0;n<o.length;n++)Math.abs(o[n])>t?o[n]=1/o[n]:o[n]=0;return o=this.constructor[Symbol.species].diag(o),s.mmul(o.mmul(e.transposeView()))}clone(){for(var t=new this.constructor[Symbol.species](this.rows,this.columns),r=0;r<this.rows;r++)for(var e=0;e<this.columns;e++)t.set(r,e,this.get(r,e));return t}}function e(t,r){return t-r}r.prototype.klass="Matrix",r.random=r.rand,r.diagonal=r.diag,r.prototype.diagonal=r.prototype.diag,r.identity=r.eye,r.prototype.negate=r.prototype.neg,r.prototype.tensorProduct=r.prototype.kroneckerProduct,r.prototype.determinant=r.prototype.det;var s,i="\n(function %name%(matrix, %args%) {\n    var newMatrix = new this[Symbol.species](matrix);\n    return newMatrix.%name%(%args%);\n})\n",a=eval;for(var g of[["+","add"],["-","sub","subtract"],["*","mul","multiply"],["/","div","divide"],["%","mod","modulus"],["&","and"],["|","or"],["^","xor"],["<<","leftShift"],[">>","signPropagatingRightShift"],[">>>","rightShift","zeroFillRightShift"]]){var w=a(F("\n(function %name%(value) {\n    if (typeof value === 'number') return this.%name%S(value);\n    return this.%name%M(value);\n})\n",{name:g[1],op:g[0]})),d=a(F("\n(function %name%S(value) {\n    for (var i = 0; i < this.rows; i++) {\n        for (var j = 0; j < this.columns; j++) {\n            this.set(i, j, this.get(i, j) %op% value);\n        }\n    }\n    return this;\n})\n",{name:`${g[1]}S`,op:g[0]})),p=a(F("\n(function %name%M(matrix) {\n    matrix = this.constructor.checkMatrix(matrix);\n    if (this.rows !== matrix.rows ||\n        this.columns !== matrix.columns) {\n        throw new RangeError('Matrices dimensions must be equal');\n    }\n    for (var i = 0; i < this.rows; i++) {\n        for (var j = 0; j < this.columns; j++) {\n            this.set(i, j, this.get(i, j) %op% matrix.get(i, j));\n        }\n    }\n    return this;\n})\n",{name:`${g[1]}M`,op:g[0]})),j=a(F("\n(function %name%(matrix, value) {\n    var newMatrix = new this[Symbol.species](matrix);\n    return newMatrix.%name%(value);\n})\n",{name:g[1]}));for(s=1;s<g.length;s++)r.prototype[g[s]]=w,r.prototype[`${g[s]}S`]=d,r.prototype[`${g[s]}M`]=p,r[g[s]]=j}var I=[["~","not"]];for(var k of(["abs","acos","acosh","asin","asinh","atan","atanh","cbrt","ceil","clz32","cos","cosh","exp","expm1","floor","fround","log","log1p","log10","log2","round","sign","sin","sinh","sqrt","tan","tanh","trunc"].forEach(function(t){I.push([`Math.${t}`,t])}),I)){var q=a(F("\n(function %name%() {\n    for (var i = 0; i < this.rows; i++) {\n        for (var j = 0; j < this.columns; j++) {\n            this.set(i, j, %method%(this.get(i, j)));\n        }\n    }\n    return this;\n})\n",{name:k[1],method:k[0]})),N=a(F("\n(function %name%(matrix) {\n    var newMatrix = new this[Symbol.species](matrix);\n    return newMatrix.%name%();\n})\n",{name:k[1]}));for(s=1;s<k.length;s++)r.prototype[k[s]]=q,r[k[s]]=N}for(var _ of[["Math.pow",1,"pow"]]){var O="arg0";for(s=1;s<_[1];s++)O+=`, arg${s}`;if(1!==_[1]){var L=a(F("\n(function %name%(%args%) {\n    for (var i = 0; i < this.rows; i++) {\n        for (var j = 0; j < this.columns; j++) {\n            this.set(i, j, %method%(this.get(i, j), %args%));\n        }\n    }\n    return this;\n})\n",{name:_[2],method:_[0],args:O})),T=a(F(i,{name:_[2],args:O}));for(s=2;s<_.length;s++)r.prototype[_[s]]=L,r[_[s]]=T}else{var z={name:_[2],args:O,method:_[0]},P=a(F("\n(function %name%(value) {\n    if (typeof value === 'number') return this.%name%S(value);\n    return this.%name%M(value);\n})\n",z)),U=a(F("\n(function %name%S(value) {\n    for (var i = 0; i < this.rows; i++) {\n        for (var j = 0; j < this.columns; j++) {\n            this.set(i, j, %method%(this.get(i, j), value));\n        }\n    }\n    return this;\n})\n",z)),$=a(F("\n(function %name%M(matrix) {\n    matrix = this.constructor.checkMatrix(matrix);\n    if (this.rows !== matrix.rows ||\n        this.columns !== matrix.columns) {\n        throw new RangeError('Matrices dimensions must be equal');\n    }\n    for (var i = 0; i < this.rows; i++) {\n        for (var j = 0; j < this.columns; j++) {\n            this.set(i, j, %method%(this.get(i, j), matrix.get(i, j)));\n        }\n    }\n    return this;\n})\n",z)),D=a(F("\n(function %name%(matrix, %args%) {\n    var newMatrix = new this[Symbol.species](matrix);\n    return newMatrix.%name%(%args%);\n})\n",z));for(s=2;s<_.length;s++)r.prototype[_[s]]=P,r.prototype[`${_[s]}M`]=$,r.prototype[`${_[s]}S`]=U,r[_[s]]=D}}function F(t,r){for(var e in r)t=t.replace(new RegExp(`%${e}%`,"g"),r[e]);return t}return r}class C extends(j(Array)){constructor(t,r){var e;if(1===arguments.length&&"number"==typeof t)return new Array(t);if(C.isMatrix(t))return t.clone();if(Number.isInteger(t)&&t>0){if(super(t),!(Number.isInteger(r)&&r>0))throw new TypeError("nColumns must be a positive integer");for(e=0;e<t;e++)this[e]=new Array(r)}else{if(!Array.isArray(t))throw new TypeError("First argument must be a positive number or an array");{const s=t;if(t=s.length,"number"!=typeof(r=s[0].length)||0===r)throw new TypeError("Data must be a 2D array with at least one element");for(super(t),e=0;e<t;e++){if(s[e].length!==r)throw new RangeError("Inconsistent array dimensions");this[e]=[].concat(s[e])}}}return this.rows=t,this.columns=r,this}set(t,r,e){return this[t][r]=e,this}get(t,r){return this[t][r]}removeRow(t){if(u(this,t),1===this.rows)throw new RangeError("A matrix cannot have less than one row");return this.splice(t,1),this.rows-=1,this}addRow(t,r){return void 0===r&&(r=t,t=this.rows),u(this,t,!0),r=f(this,r),this.splice(t,0,r),this.rows+=1,this}removeColumn(t){if(l(this,t),1===this.columns)throw new RangeError("A matrix cannot have less than one column");for(var r=0;r<this.rows;r++)this[r].splice(t,1);return this.columns-=1,this}addColumn(t,r){void 0===r&&(r=t,t=this.columns),l(this,t,!0),r=c(this,r);for(var e=0;e<this.rows;e++)this[e].splice(t,0,r[e]);return this.columns+=1,this}}class I extends(j()){constructor(t){super(),this.data=t,this.rows=t.length,this.columns=t[0].length}set(t,r,e){return this.data[t][r]=e,this}get(t,r){return this.data[t][r]}static get[Symbol.species](){return C}}class k{constructor(t,r={}){const{assumeSymmetric:e=!1}=r;if(!(t=I.checkMatrix(t)).isSquare())throw new Error("Matrix is not a square matrix");var s,o,n=t.columns,h=a(n,n,0),u=new Array(n),l=new Array(n),f=t;if(!!e||t.isSymmetric()){for(s=0;s<n;s++)for(o=0;o<n;o++)h[s][o]=f.get(s,o);!function(t,r,e,s){var o,n,i,a,h,u,l,f;for(h=0;h<t;h++)e[h]=s[t-1][h];for(a=t-1;a>0;a--){for(f=0,i=0,u=0;u<a;u++)f+=Math.abs(e[u]);if(0===f)for(r[a]=e[a-1],h=0;h<a;h++)e[h]=s[a-1][h],s[a][h]=0,s[h][a]=0;else{for(u=0;u<a;u++)e[u]/=f,i+=e[u]*e[u];for(o=e[a-1],n=Math.sqrt(i),o>0&&(n=-n),r[a]=f*n,i-=o*n,e[a-1]=o-n,h=0;h<a;h++)r[h]=0;for(h=0;h<a;h++){for(o=e[h],s[h][a]=o,n=r[h]+s[h][h]*o,u=h+1;u<=a-1;u++)n+=s[u][h]*e[u],r[u]+=s[u][h]*o;r[h]=n}for(o=0,h=0;h<a;h++)r[h]/=i,o+=r[h]*e[h];for(l=o/(i+i),h=0;h<a;h++)r[h]-=l*e[h];for(h=0;h<a;h++){for(o=e[h],n=r[h],u=h;u<=a-1;u++)s[u][h]-=o*r[u]+n*e[u];e[h]=s[a-1][h],s[a][h]=0}}e[a]=i}for(a=0;a<t-1;a++){if(s[t-1][a]=s[a][a],s[a][a]=1,0!==(i=e[a+1])){for(u=0;u<=a;u++)e[u]=s[u][a+1]/i;for(h=0;h<=a;h++){for(n=0,u=0;u<=a;u++)n+=s[u][a+1]*s[u][h];for(u=0;u<=a;u++)s[u][h]-=n*e[u]}}for(u=0;u<=a;u++)s[u][a+1]=0}for(h=0;h<t;h++)e[h]=s[t-1][h],s[t-1][h]=0;s[t-1][t-1]=1,r[0]=0}(n,l,u,h),function(t,r,e,s){var o,n,a,h,u,l,f,c,m,g,w,v,d,p,M,b;for(a=1;a<t;a++)r[a-1]=r[a];r[t-1]=0;var x=0,y=0,S=Number.EPSILON;for(l=0;l<t;l++){for(y=Math.max(y,Math.abs(e[l])+Math.abs(r[l])),f=l;f<t&&!(Math.abs(r[f])<=S*y);)f++;if(f>l){0;do{for(1,o=e[l],c=(e[l+1]-o)/(2*r[l]),m=i(c,1),c<0&&(m=-m),e[l]=r[l]/(c+m),e[l+1]=r[l]*(c+m),g=e[l+1],n=o-e[l],a=l+2;a<t;a++)e[a]-=n;for(x+=n,c=e[f],v=w=1,d=w,p=r[l+1],M=0,b=0,a=f-1;a>=l;a--)for(d=v,v=w,b=M,o=w*r[a],n=w*c,m=i(c,r[a]),r[a+1]=M*m,M=r[a]/m,c=(w=c/m)*e[a]-M*o,e[a+1]=n+M*(w*o+M*e[a]),u=0;u<t;u++)n=s[u][a+1],s[u][a+1]=M*s[u][a]+w*n,s[u][a]=w*s[u][a]-M*n;c=-M*b*d*p*r[l]/g,r[l]=M*c,e[l]=w*c}while(Math.abs(r[l])>S*y)}e[l]=e[l]+x,r[l]=0}for(a=0;a<t-1;a++){for(u=a,c=e[a],h=a+1;h<t;h++)e[h]<c&&(u=h,c=e[h]);if(u!==a)for(e[u]=e[a],e[a]=c,h=0;h<t;h++)c=s[h][a],s[h][a]=s[h][u],s[h][u]=c}}(n,l,u,h)}else{var c=a(n,n,0),m=new Array(n);for(o=0;o<n;o++)for(s=0;s<n;s++)c[s][o]=f.get(s,o);!function(t,r,e,s){var o,n,i,a,h,u,l,f=t-1;for(u=1;u<=f-1;u++){for(l=0,a=u;a<=f;a++)l+=Math.abs(r[a][u-1]);if(0!==l){for(i=0,a=f;a>=u;a--)e[a]=r[a][u-1]/l,i+=e[a]*e[a];for(n=Math.sqrt(i),e[u]>0&&(n=-n),i-=e[u]*n,e[u]=e[u]-n,h=u;h<t;h++){for(o=0,a=f;a>=u;a--)o+=e[a]*r[a][h];for(o/=i,a=u;a<=f;a++)r[a][h]-=o*e[a]}for(a=0;a<=f;a++){for(o=0,h=f;h>=u;h--)o+=e[h]*r[a][h];for(o/=i,h=u;h<=f;h++)r[a][h]-=o*e[h]}e[u]=l*e[u],r[u][u-1]=l*n}}for(a=0;a<t;a++)for(h=0;h<t;h++)s[a][h]=a===h?1:0;for(u=f-1;u>=1;u--)if(0!==r[u][u-1]){for(a=u+1;a<=f;a++)e[a]=r[a][u-1];for(h=u;h<=f;h++){for(n=0,a=u;a<=f;a++)n+=e[a]*s[a][h];for(n=n/e[u]/r[u][u-1],a=u;a<=f;a++)s[a][h]+=n*e[a]}}}(n,c,m,h),function(t,r,e,s,o){var n,i,a,h,u,l,f,c,m,g,w,v,d,p,M,b=t-1,x=t-1,y=Number.EPSILON,S=0,E=0,A=0,R=0,V=0,j=0,C=0,I=0;for(n=0;n<t;n++)for((n<0||n>x)&&(e[n]=o[n][n],r[n]=0),i=Math.max(n-1,0);i<t;i++)E+=Math.abs(o[n][i]);for(;b>=0;){for(h=b;h>0&&(0===(j=Math.abs(o[h-1][h-1])+Math.abs(o[h][h]))&&(j=E),!(Math.abs(o[h][h-1])<y*j));)h--;if(h===b)o[b][b]=o[b][b]+S,e[b]=o[b][b],r[b]=0,b--,I=0;else if(h===b-1){if(f=o[b][b-1]*o[b-1][b],A=(o[b-1][b-1]-o[b][b])/2,R=A*A+f,C=Math.sqrt(Math.abs(R)),o[b][b]=o[b][b]+S,o[b-1][b-1]=o[b-1][b-1]+S,c=o[b][b],R>=0){for(C=A>=0?A+C:A-C,e[b-1]=c+C,e[b]=e[b-1],0!==C&&(e[b]=c-f/C),r[b-1]=0,r[b]=0,c=o[b][b-1],j=Math.abs(c)+Math.abs(C),A=c/j,R=C/j,V=Math.sqrt(A*A+R*R),A/=V,R/=V,i=b-1;i<t;i++)C=o[b-1][i],o[b-1][i]=R*C+A*o[b][i],o[b][i]=R*o[b][i]-A*C;for(n=0;n<=b;n++)C=o[n][b-1],o[n][b-1]=R*C+A*o[n][b],o[n][b]=R*o[n][b]-A*C;for(n=0;n<=x;n++)C=s[n][b-1],s[n][b-1]=R*C+A*s[n][b],s[n][b]=R*s[n][b]-A*C}else e[b-1]=c+A,e[b]=c+A,r[b-1]=C,r[b]=-C;b-=2,I=0}else{if(c=o[b][b],m=0,f=0,h<b&&(m=o[b-1][b-1],f=o[b][b-1]*o[b-1][b]),10===I){for(S+=c,n=0;n<=b;n++)o[n][n]-=c;j=Math.abs(o[b][b-1])+Math.abs(o[b-1][b-2]),c=m=.75*j,f=-.4375*j*j}if(30===I&&(j=(j=(m-c)/2)*j+f)>0){for(j=Math.sqrt(j),m<c&&(j=-j),j=c-f/((m-c)/2+j),n=0;n<=b;n++)o[n][n]-=j;S+=j,c=m=f=.964}for(I+=1,u=b-2;u>=h&&(C=o[u][u],A=((V=c-C)*(j=m-C)-f)/o[u+1][u]+o[u][u+1],R=o[u+1][u+1]-C-V-j,V=o[u+2][u+1],j=Math.abs(A)+Math.abs(R)+Math.abs(V),A/=j,R/=j,V/=j,u!==h)&&!(Math.abs(o[u][u-1])*(Math.abs(R)+Math.abs(V))<y*(Math.abs(A)*(Math.abs(o[u-1][u-1])+Math.abs(C)+Math.abs(o[u+1][u+1]))));)u--;for(n=u+2;n<=b;n++)o[n][n-2]=0,n>u+2&&(o[n][n-3]=0);for(a=u;a<=b-1&&(p=a!==b-1,a!==u&&(A=o[a][a-1],R=o[a+1][a-1],V=p?o[a+2][a-1]:0,0!==(c=Math.abs(A)+Math.abs(R)+Math.abs(V))&&(A/=c,R/=c,V/=c)),0!==c);a++)if(j=Math.sqrt(A*A+R*R+V*V),A<0&&(j=-j),0!==j){for(a!==u?o[a][a-1]=-j*c:h!==u&&(o[a][a-1]=-o[a][a-1]),c=(A+=j)/j,m=R/j,C=V/j,R/=A,V/=A,i=a;i<t;i++)A=o[a][i]+R*o[a+1][i],p&&(A+=V*o[a+2][i],o[a+2][i]=o[a+2][i]-A*C),o[a][i]=o[a][i]-A*c,o[a+1][i]=o[a+1][i]-A*m;for(n=0;n<=Math.min(b,a+3);n++)A=c*o[n][a]+m*o[n][a+1],p&&(A+=C*o[n][a+2],o[n][a+2]=o[n][a+2]-A*V),o[n][a]=o[n][a]-A,o[n][a+1]=o[n][a+1]-A*R;for(n=0;n<=x;n++)A=c*s[n][a]+m*s[n][a+1],p&&(A+=C*s[n][a+2],s[n][a+2]=s[n][a+2]-A*V),s[n][a]=s[n][a]-A,s[n][a+1]=s[n][a+1]-A*R}}}if(0===E)return;for(b=t-1;b>=0;b--)if(A=e[b],0===(R=r[b]))for(h=b,o[b][b]=1,n=b-1;n>=0;n--){for(f=o[n][n]-A,V=0,i=h;i<=b;i++)V+=o[n][i]*o[i][b];if(r[n]<0)C=f,j=V;else if(h=n,0===r[n]?o[n][b]=0!==f?-V/f:-V/(y*E):(c=o[n][n+1],m=o[n+1][n],R=(e[n]-A)*(e[n]-A)+r[n]*r[n],l=(c*j-C*V)/R,o[n][b]=l,o[n+1][b]=Math.abs(c)>Math.abs(C)?(-V-f*l)/c:(-j-m*l)/C),l=Math.abs(o[n][b]),y*l*l>1)for(i=n;i<=b;i++)o[i][b]=o[i][b]/l}else if(R<0)for(h=b-1,Math.abs(o[b][b-1])>Math.abs(o[b-1][b])?(o[b-1][b-1]=R/o[b][b-1],o[b-1][b]=-(o[b][b]-A)/o[b][b-1]):(M=q(0,-o[b-1][b],o[b-1][b-1]-A,R),o[b-1][b-1]=M[0],o[b-1][b]=M[1]),o[b][b-1]=0,o[b][b]=1,n=b-2;n>=0;n--){for(g=0,w=0,i=h;i<=b;i++)g+=o[n][i]*o[i][b-1],w+=o[n][i]*o[i][b];if(f=o[n][n]-A,r[n]<0)C=f,V=g,j=w;else if(h=n,0===r[n]?(M=q(-g,-w,f,R),o[n][b-1]=M[0],o[n][b]=M[1]):(c=o[n][n+1],m=o[n+1][n],v=(e[n]-A)*(e[n]-A)+r[n]*r[n]-R*R,d=2*(e[n]-A)*R,0===v&&0===d&&(v=y*E*(Math.abs(f)+Math.abs(R)+Math.abs(c)+Math.abs(m)+Math.abs(C))),M=q(c*V-C*g+R*w,c*j-C*w-R*g,v,d),o[n][b-1]=M[0],o[n][b]=M[1],Math.abs(c)>Math.abs(C)+Math.abs(R)?(o[n+1][b-1]=(-g-f*o[n][b-1]+R*o[n][b])/c,o[n+1][b]=(-w-f*o[n][b]-R*o[n][b-1])/c):(M=q(-V-m*o[n][b-1],-j-m*o[n][b],C,R),o[n+1][b-1]=M[0],o[n+1][b]=M[1])),l=Math.max(Math.abs(o[n][b-1]),Math.abs(o[n][b])),y*l*l>1)for(i=n;i<=b;i++)o[i][b-1]=o[i][b-1]/l,o[i][b]=o[i][b]/l}for(n=0;n<t;n++)if(n<0||n>x)for(i=n;i<t;i++)s[n][i]=o[n][i];for(i=t-1;i>=0;i--)for(n=0;n<=x;n++){for(C=0,a=0;a<=Math.min(i,x);a++)C+=s[n][a]*o[a][i];s[n][i]=C}}(n,l,u,h,c)}this.n=n,this.e=l,this.d=u,this.V=h}get realEigenvalues(){return this.d}get imaginaryEigenvalues(){return this.e}get eigenvectorMatrix(){return C.isMatrix(this.V)||(this.V=new C(this.V)),this.V}get diagonalMatrix(){var t,r,e=this.n,s=this.e,o=this.d,n=new C(e,e);for(t=0;t<e;t++){for(r=0;r<e;r++)n[t][r]=0;n[t][t]=o[t],s[t]>0?n[t][t+1]=s[t]:s[t]<0&&(n[t][t-1]=s[t])}return n}}function q(t,r,e,s){var o,n;return Math.abs(e)>Math.abs(s)?[(t+(o=s/e)*r)/(n=e+o*s),(r-o*t)/n]:[((o=e/s)*t+r)/(n=s+o*e),(o*r-t)/n]}var N=e(0);self.addEventListener("message",function(t){var r=t.data.nodes,e=t.data.edges;new class{constructor(t,r){this._nodes=t,this._edges=r}apply(){let t=Object(N.create2dArray)(this._nodes.length,this._nodes.length);for(let r=0;r<this._edges.length;++r){let e=this._edges[r].source.index,s=this._edges[r].target.index;t[e][s]=-1,t[s][e]=-1}for(let r=0;r<this._nodes.length;++r)t[r][r]=-t[r].reduce((t,r)=>t+r,0);let r=new k(t);const e=function(t){const r=Math.min.apply(null,t);t[t.indexOf(r)]=1/0;const e=Math.min.apply(null,t),s=t.indexOf(e);t[s]=1/0;const o=Math.min.apply(null,t);return[s,t.indexOf(o)]}(r.realEigenvalues),s=r.eigenvectorMatrix.transpose(),o=function(t,r){let e=Math.max.apply(null,t.map(Math.abs)),s=Math.max.apply(null,r.map(Math.abs)),o=Math.min.apply(null,t),n=Math.min.apply(null,r);for(let i=0;i<t.length;++i)t[i]=.1+(t[i]-o)/(1.25*(e-o)),r[i]=.1+(r[i]-n)/(1.25*(s-n));return[t,r]}(s[e[0]],s[e[1]]);this._nodes.forEach(function(t,r){t.x=o[0][r],t.y=o[1][r]})}}(r,e,t.data.layout_options).apply(),self.postMessage({nodes:r,edges:e})},!1)}]);